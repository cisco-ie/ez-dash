version: '3'
services:
    influx:
      image: influxdb
    elasticsearch:
      image: docker.elastic.co/elasticsearch/elasticsearch-oss:6.2.3
      environment:
        - discovery.type=single-node
    prometheus:
      image: prom/prometheus
      volumes:
        - "./prometheus/prometheus.yml:/etc/prometheus/prometheus.yml:ro"
        - "./prometheus/rules.d:/etc/prometheus/rules.d:ro"
      ports:
        - "9090:9090"
    grafana:
      image: grafana/grafana
      ports:
        - "3000:3000"
      volumes:
        - "./grafana/datasources.yml:/etc/grafana/provisioning/datasources/datasources.yml:ro"
    python_app:
      build: python
      image: ez-dash/python
      stdin_open: true
      tty: true
      ports:
        - "9091:9091"
      depends_on:
        - influx
        - prometheus
        - elasticsearch
